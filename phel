#!/usr/bin/env php
<?php

$slash = DIRECTORY_SEPARATOR;

use Gacela\Framework\Config;
use Phel\Main\MainFacade;

$projectRootDir = getcwd() . $slash;
$autoloadPath = $projectRootDir . 'vendor' . $slash . 'autoload.php';

if (!file_exists($autoloadPath)) {
    exit("Cannot load composer's autoload file: " . $autoloadPath);
}

require $autoloadPath;

if ($argc <= 1) {
    exit(MainFacade::HELP_TEXT);
}

Config::setApplicationRootDir(getcwd());

try {
    $facade = new MainFacade();
    $facade->runCommand($argv[1], array_slice($argv, 2));
} catch (Throwable $e) {
    print $e->getMessage() . PHP_EOL;
}
